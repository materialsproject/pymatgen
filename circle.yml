machine:
  timezone:
    America/Los_Angeles
dependencies:
  override:
    - pip install -q numpy
    - pip install -r requirements.txt
    - pip install -r requirements-optional.txt
    - sudo apt-get install python-vtk
    - pip install -Iv https://wiki.fysik.dtu.dk/ase-files/python-ase-3.7.1.3184.tar.gz
    - python setup.py develop
test:
  override:
    - nosetests:
        environment:
            PATH: $PATH:`pwd`/cmd_line/enum/Linux_64bit:`pwd`/cmd_line/bader/Linux_64bit:`pwd`/cmd_line/gulp/Linux_64bit:`pwd`/cmd_line/aconvasp/Linux_64bit
            GULP_LIB: /`pwd`/cmd_line/gulp/Libraries
            PYTHONPATH: $PYTHONPATH:/usr/lib/python2.7/dist-packages/
deployment:
  automerge:
    branch: [master]
    commands:
      - git config --global push.default simple
      - git config --global user.email "ongsp@ucsd.edu"
      - git config --global user.name "Shyue Ping Ong"
      - git checkout stable_py3
      - git merge -m "Automated merge for py3k testing" master
      - git push
      - git checkout master
